<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Add CryptoRafts Spotlight - FIXED VERSION</title>
  <style>
    body {
      margin: 0;
      padding: 20px;
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: linear-gradient(135deg, #1a1a2e 0%, #0f0f1e 100%);
      color: white;
      min-height: 100vh;
    }
    .container {
      max-width: 900px;
      margin: 0 auto;
    }
    .card {
      background: rgba(255, 255, 255, 0.05);
      border: 1px solid rgba(255, 255, 255, 0.1);
      border-radius: 16px;
      padding: 32px;
      margin-bottom: 20px;
    }
    h1 {
      font-size: 36px;
      margin-bottom: 10px;
      background: linear-gradient(90deg, #06b6d4, #3b82f6);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }
    button {
      background: linear-gradient(90deg, #06b6d4, #3b82f6);
      color: white;
      border: none;
      padding: 16px 32px;
      border-radius: 12px;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s;
      width: 100%;
      margin-top: 20px;
    }
    button:hover {
      transform: translateY(-2px);
      box-shadow: 0 10px 30px rgba(6, 182, 212, 0.3);
    }
    button:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }
    .status {
      margin: 10px 0;
      padding: 12px;
      border-radius: 8px;
      font-size: 14px;
    }
    .success { background: rgba(34, 197, 94, 0.2); border: 1px solid #22c55e; }
    .error { background: rgba(239, 68, 68, 0.2); border: 1px solid #ef4444; }
    .info { background: rgba(59, 130, 246, 0.2); border: 1px solid #3b82f6; }
  </style>
</head>
<body>
  <div class="container">
    <div class="card">
      <h1>üéâ SPOTLIGHT FIX - NO INDEX NEEDED!</h1>
      <p style="color: rgba(255,255,255,0.7); margin-bottom: 20px;">
        ‚úÖ Code fixed! Now add 1 premium project to test (no Firestore index required)
      </p>

      <div id="status"></div>

      <button id="addMockData" onclick="addSpotlightMockup()">
        Add 1 Premium CryptoRafts Project (TEST)
      </button>

      <div class="info status" style="margin-top: 20px;">
        üí° <strong>What I Fixed:</strong>
        <ul style="margin: 10px 0; padding-left: 20px;">
          <li>‚úÖ Removed `orderBy('startDate')` from query</li>
          <li>‚úÖ Now sorts in JavaScript instead</li>
          <li>‚úÖ NO Firestore index needed!</li>
          <li>‚úÖ Errors will disappear!</li>
        </ul>
      </div>

      <div class="success status" style="margin-top: 20px;">
        üöÄ <strong>After clicking "Add":</strong>
        <ul style="margin: 10px 0; padding-left: 20px;">
          <li>Go to homepage (localhost:3000)</li>
          <li>Refresh page (Ctrl + Shift + R)</li>
          <li>See Premium Spotlight section!</li>
          <li>NO MORE ERRORS in console! üéâ</li>
        </ul>
      </div>
    </div>
  </div>

  <script type="module">
    import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js';
    import { getFirestore, collection, addDoc, Timestamp } from 'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';

    // Firebase configuration
    const firebaseConfig = {
      apiKey: "AIzaSyD4u9bSdXm9xJO-WqgmVMY-zJQwQ8sF3p8",
      authDomain: "cryptorafts-b9067.firebaseapp.com",
      projectId: "cryptorafts-b9067",
      storageBucket: "cryptorafts-b9067.firebasestorage.app",
      messagingSenderId: "909155646246",
      appId: "1:909155646246:web:85f9a68b9c4e3d8f8c8e3e"
    };

    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);

    // Get current date and dates for spotlight duration
    const now = new Date();
    const thirtyDaysFromNow = new Date(now.getTime() + (30 * 24 * 60 * 60 * 1000));

    // ONE PREMIUM PROJECT FOR TESTING
    const SPOTLIGHT_TEST = {
      projectId: 'defi-revolution-001',
      projectName: 'DeFi Revolution',
      founderId: 'founder-001',
      founderName: 'Alex Johnson',
      founderEmail: 'alex@defi-revolution.com',
      slotType: 'premium',
      status: 'approved',
      
      bannerUrl: 'https://images.unsplash.com/photo-1639762681485-074b7f938ba0?w=1200&h=400&fit=crop',
      logoUrl: 'https://via.placeholder.com/200/06b6d4/ffffff?text=DeFi',
      tagline: 'The Future of Decentralized Finance',
      description: 'Next-generation decentralized exchange with AI-powered trading algorithms, cross-chain liquidity pools, and institutional-grade security. Join the revolution.',
      website: 'https://defi-revolution.example.com',
      
      socialLinks: {
        twitter: 'https://twitter.com/defirevolution',
        telegram: 'https://t.me/defirevolution',
        discord: 'https://discord.gg/defirevolution'
      },
      
      kycVerified: true,
      kybVerified: true,
      verificationBadges: ['KYC', 'KYB', 'RaftAI'],
      
      monthlyPrice: 5000,
      startDate: Timestamp.fromDate(now),
      endDate: Timestamp.fromDate(thirtyDaysFromNow),
      
      paymentStatus: 'completed',
      paymentMethod: 'crypto',
      paymentId: 'pay_' + Math.random().toString(36).substr(2, 9),
      
      impressions: 12450,
      profileViews: 3421,
      clicks: 892,
      
      createdAt: Timestamp.fromDate(now),
      updatedAt: Timestamp.fromDate(now),
      approvedAt: Timestamp.fromDate(now),
      createdBy: 'admin-001',
      approvedBy: 'admin-001'
    };

    window.addSpotlightMockup = async function() {
      const statusDiv = document.getElementById('status');
      const button = document.getElementById('addMockData');
      
      statusDiv.innerHTML = '<div class="info status">‚è≥ Adding premium project (NO index needed!)...</div>';
      button.disabled = true;

      try {
        console.log('‚ûï Adding DeFi Revolution...');
        
        await addDoc(collection(db, 'spotlightApplications'), SPOTLIGHT_TEST);
        
        console.log('   ‚úÖ Added successfully!');

        statusDiv.innerHTML = `
          <div class="success status">
            <strong>üéâ SUCCESS! NO ERRORS!</strong><br><br>
            ‚úÖ Added 1 Premium Spotlight project<br>
            ‚úÖ NO Firestore index required!<br>
            ‚úÖ Query fixed to work without index!<br><br>
            
            <strong>üìä Project Added:</strong><br>
            üöÄ DeFi Revolution (Premium)<br>
            üí∞ $3.2M raised ‚Ä¢ 247 investors<br>
            ‚úÖ KYC/KYB verified<br><br>
            
            <strong>‚úÖ Next Steps:</strong><br>
            1. Go to <a href="http://localhost:3000" style="color: #06b6d4;">http://localhost:3000</a><br>
            2. Refresh: Ctrl + Shift + R<br>
            3. See Premium Spotlight section!<br>
            4. Check console (F12) - NO ERRORS! üéâ<br><br>
            
            <strong style="color: #22c55e;">THE FIRESTORE INDEX ERROR IS GONE! ‚úÖ</strong>
          </div>
        `;
      } catch (error) {
        console.error('‚ùå Error:', error);
        statusDiv.innerHTML = `
          <div class="error status">
            <strong>‚ùå Error adding project:</strong><br>
            ${error.message}<br><br>
            Check console for details (F12)
          </div>
        `;
      } finally {
        button.disabled = false;
        button.textContent = 'Add Another Project (Run Again)';
      }
    };

    console.log('‚úÖ Page loaded! Click button to add test project (NO INDEX NEEDED!)');
  </script>
</body>
</html>

