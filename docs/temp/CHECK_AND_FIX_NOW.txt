cd /var/www/cryptorafts && echo "ðŸ” Checking current status..." && echo "" && echo "ðŸ“Š PM2 Status:" && pm2 status && echo "" && echo "ðŸ“‹ Checking if .next directory exists..." && ls -la .next 2>/dev/null || echo "âŒ .next directory NOT found!" && echo "" && echo "ðŸ“‹ Current PM2 logs (last 5 lines):" && pm2 logs cryptorafts --lines 5 --nostream && echo "" && echo "ðŸ”§ Testing server directly..." && curl -s http://localhost:3000 | head -20 && echo "" && echo "ðŸ“‹ If server not responding, rebuilding..." && pm2 stop cryptorafts && pm2 delete cryptorafts && rm -rf .next out node_modules package-lock.json && export NVM_DIR="$HOME/.nvm" && . "$NVM_DIR/nvm.sh" && nvm use 20 && echo "ðŸ“¦ Reinstalling dependencies..." && npm install --legacy-peer-deps && echo "ðŸ”¨ Rebuilding..." && NODE_ENV=production npm run build && echo "âœ… Build completed!" && echo "" && echo "ðŸš€ Restarting PM2..." && pm2 start ecosystem.config.js && pm2 save && pm2 status && sleep 5 && echo "" && echo "ðŸ“‹ PM2 Logs after restart:" && pm2 logs cryptorafts --lines 10 --nostream && echo "" && echo "ðŸŒ Testing server:" && curl -I http://localhost:3000 2>&1 | head -5 && echo "" && echo "âœ… If you see HTTP/1.1 200 OK, app is working!"

